{"script":"-- key limit interval now\nlocal limit = tonumber(ARGV[1])\nlocal interval = tonumber(ARGV[2])\nlocal now = tonumber(ARGV[3])\nredis.call('ZREMRANGEBYSCORE', KEYS[1], '-inf', now - interval)\nlocal num = redis.call('ZCARD', KEYS[1])\nif num >= limit then\n    return -1\nend\nnum = num + redis.call('ZADD', KEYS[1], now, now)\nredis.call('PEXPIRE', KEYS[1], interval)\nreturn limit - num","sha1":"3ee0a8cbcdfd39d9b0ef0d37c36ed23def525792"}